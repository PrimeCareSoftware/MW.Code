<mat-card>
  <mat-card-header>
    <mat-card-title>
      <mat-icon>download</mat-icon>
      Portabilidade de Dados
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <div class="portability-content">
      <div class="info-section">
        <mat-icon color="primary">info</mat-icon>
        <div>
          <h3>Direito à Portabilidade</h3>
          <p>
            Você tem o direito de solicitar uma cópia de todos os seus dados pessoais
            armazenados em nosso sistema. Escolha o formato desejado e faça o download.
          </p>
        </div>
      </div>

      <div class="format-selection">
        <h3>Selecione o Formato de Exportação</h3>
        
        <mat-radio-group [(ngModel)]="selectedFormat" class="format-options">
          <div *ngFor="let format of formats" class="format-option">
            <mat-radio-button [value]="format.value">
              <div class="format-details">
                <div class="format-header">
                  <mat-icon>{{ format.icon }}</mat-icon>
                  <strong>{{ format.label }}</strong>
                </div>
                <p class="format-description">{{ format.description }}</p>
              </div>
            </mat-radio-button>
          </div>
        </mat-radio-group>
      </div>

      <div *ngIf="loading" class="loading-container">
        <mat-spinner diameter="40"></mat-spinner>
        <p>Preparando exportação...</p>
      </div>

      <div *ngIf="error" class="message-container error">
        <mat-icon>error</mat-icon>
        <p>{{ error }}</p>
      </div>

      <div *ngIf="successMessage" class="message-container success">
        <mat-icon>check_circle</mat-icon>
        <p>{{ successMessage }}</p>
      </div>

      <div class="export-info">
        <h4>O que será exportado?</h4>
        <ul>
          <li>Dados pessoais (nome, CPF, e-mail, telefone, endereço)</li>
          <li>Histórico de consultas e agendamentos</li>
          <li>Registros médicos e resultados de exames</li>
          <li>Histórico de consentimentos</li>
          <li>Logs de acesso aos seus dados (quando aplicável)</li>
        </ul>
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="executeExport()"
      [disabled]="loading">
      <mat-icon>download</mat-icon>
      Exportar Dados
    </button>
  </mat-card-actions>
</mat-card>

<style>
  mat-card {
    max-width: 900px;
    margin: 20px auto;
  }

  mat-card-title {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .portability-content {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .info-section {
    display: flex;
    gap: 16px;
    padding: 16px;
    background: #e3f2fd;
    border-radius: 8px;
    align-items: flex-start;
  }

  .info-section mat-icon {
    margin-top: 4px;
  }

  .info-section h3 {
    margin: 0 0 8px 0;
    color: #1976d2;
  }

  .info-section p {
    margin: 0;
    color: #666;
  }

  .format-selection h3 {
    margin-bottom: 16px;
    color: #333;
  }

  .format-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .format-option {
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 16px;
    transition: all 0.2s;
  }

  .format-option:hover {
    background: #f5f5f5;
    border-color: #1976d2;
  }

  .format-details {
    margin-left: 8px;
  }

  .format-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 4px;
  }

  .format-description {
    margin: 0;
    color: #666;
    font-size: 14px;
  }

  .loading-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    padding: 20px;
  }

  .message-container {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    border-radius: 8px;
  }

  .message-container.error {
    background: #ffebee;
    color: #c62828;
  }

  .message-container.success {
    background: #e8f5e9;
    color: #2e7d32;
  }

  .message-container p {
    margin: 0;
  }

  .export-info {
    padding: 16px;
    background: #f5f5f5;
    border-radius: 8px;
  }

  .export-info h4 {
    margin: 0 0 12px 0;
    color: #333;
  }

  .export-info ul {
    margin: 0;
    padding-left: 20px;
  }

  .export-info li {
    margin: 8px 0;
    color: #666;
  }

  mat-card-actions {
    padding: 16px;
    display: flex;
    justify-content: flex-end;
  }
</style>
