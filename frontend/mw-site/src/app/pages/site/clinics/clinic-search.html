<app-header></app-header>

<main class="omni-care-site">
  <section class="section-padding">
    <div class="container-custom">
      <!-- Header -->
      <div class="clinic-search-header">
        <span class="section-badge">
          Rede de Clínicas
        </span>
        <h1 class="section-title">
          Encontre a clínica <span class="text-gradient">perfeita para você</span>
        </h1>
        <p class="section-description">
          Mais de 500 clínicas e profissionais credenciados em todo o Brasil.
        </p>
      </div>

      <!-- Filters -->
      <div class="card-elevated search-bar">
        <div class="search-filters">
          <div class="search-input-wrapper">
            <span class="material-icons search-icon">search</span>
            <input 
              type="text" 
              [(ngModel)]="searchName" 
              placeholder="Buscar clínica por nome..."
              class="omni-input"
              (keyup.enter)="onSearch()"
            />
          </div>

          <div class="filter-select-wrapper">
            <span class="material-icons filter-icon">location_on</span>
            <input 
              type="text" 
              [(ngModel)]="searchCity" 
              placeholder="Cidade"
              class="omni-input"
              (keyup.enter)="onSearch()"
            />
          </div>

          <div class="filter-select-wrapper">
            <span class="material-icons filter-icon">medical_services</span>
            <select 
              [(ngModel)]="searchClinicType" 
              class="omni-select"
              (change)="onSearch()">
              <option *ngFor="let type of clinicTypes" [value]="type.value">
                {{ type.label }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Carregando clínicas...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="error-state">
        <span class="material-icons error-icon">error</span>
        <p>{{ error }}</p>
        <button class="omni-btn omni-btn-primary" (click)="searchClinics()">Tentar Novamente</button>
      </div>

      <!-- Results -->
      <div *ngIf="!loading && !error" class="search-results">
        <p class="results-count">
          <span *ngIf="totalCount > 0">{{ totalCount }} clínicas encontradas</span>
          <span *ngIf="totalCount === 0">Nenhuma clínica encontrada com os filtros selecionados.</span>
        </p>

        <!-- Clinics Grid -->
        <div class="clinics-grid">
          <div *ngFor="let clinic of clinics; let i = index" 
               class="clinic-card card-elevated"
               [style.animation-delay]="(i * 0.05) + 's'">
            <!-- Image/Icon Header -->
            <div class="clinic-image">
              <div class="clinic-icon-wrapper">
                <span class="material-icons clinic-icon">medical_services</span>
              </div>
              <div class="clinic-rating" *ngIf="clinic.rating">
                <span class="material-icons star-icon">star</span>
                {{ clinic.rating | number:'1.1-1' }} ({{ clinic.reviewCount || 0 }})
              </div>
            </div>

            <!-- Content -->
            <div class="clinic-content">
              <div class="clinic-header">
                <h3 class="clinic-name">{{ clinic.name }}</h3>
                <span class="clinic-specialty-badge">{{ getClinicTypeLabel(clinic.clinicType) }}</span>
              </div>

              <div class="clinic-info">
                <div class="info-item">
                  <span class="material-icons info-icon">location_on</span>
                  <span class="info-text">{{ clinic.address }}</span>
                </div>

                <div class="info-item" *ngIf="clinic.city && clinic.state">
                  <span class="material-icons info-icon">place</span>
                  <span class="info-text">{{ clinic.city }} - {{ clinic.state }}</span>
                </div>

                <div class="info-item" *ngIf="clinic.openingTime && clinic.closingTime">
                  <span class="material-icons info-icon">schedule</span>
                  <span class="info-text">{{ formatTime(clinic.openingTime) }} - {{ formatTime(clinic.closingTime) }}</span>
                </div>

                <div class="info-item" *ngIf="clinic.phone">
                  <span class="material-icons info-icon">phone</span>
                  <span class="info-text">{{ clinic.phone }}</span>
                </div>
              </div>

              <div class="clinic-footer">
                <span class="professionals-count" *ngIf="clinic.professionalCount">
                  {{ clinic.professionalCount }} profissionais
                </span>
                <button 
                  class="omni-btn omni-btn-primary btn-schedule" 
                  (click)="scheduleAppointment(clinic)"
                  [disabled]="!clinic.isAcceptingNewPatients">
                  <span class="material-icons btn-icon">event</span>
                  Agendar
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="totalCount === 0" class="empty-state">
          <span class="material-icons empty-icon">search_off</span>
          <p>Nenhuma clínica encontrada com os filtros selecionados.</p>
          <button class="omni-btn omni-btn-secondary" (click)="clearFilters()">Limpar Filtros</button>
        </div>

        <!-- Pagination -->
        <div *ngIf="totalPages > 1" class="pagination">
          <button 
            class="omni-btn omni-btn-outline" 
            (click)="goToPage(currentPage - 1)"
            [disabled]="currentPage === 1">
            ‹ Anterior
          </button>
          
          <button 
            *ngFor="let page of getPaginationArray()"
            class="omni-btn omni-btn-outline"
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
            {{ page }}
          </button>
          
          <button 
            class="omni-btn omni-btn-outline" 
            (click)="goToPage(currentPage + 1)"
            [disabled]="currentPage === totalPages">
            Próxima ›
          </button>
        </div>
      </div>
    </div>
  </section>
</main>

<app-footer></app-footer>
