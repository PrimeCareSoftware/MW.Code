

<div class="public-display-container">
  <div class="page-header">
    <h1>Visibilidade no Site Público</h1>
    <p>Configure se sua clínica deve aparecer na página de pesquisa pública do site</p>
  </div>

  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Carregando configurações...</p>
    </div>
  } @else {
    @if (errorMessage()) {
      <div class="alert alert-error">
        {{ errorMessage() }}
      </div>
    }

    @if (successMessage()) {
      <div class="alert alert-success">
        {{ successMessage() }}
      </div>
    }

    <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="settings-form">
      <div class="form-card">
        <h3>Configurações de Visibilidade</h3>
        
        <div class="info-box">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8" x2="12.01" y2="8"></line>
          </svg>
          <p>Ao habilitar a exibição pública, sua clínica aparecerá na página de pesquisa do site, permitindo que novos pacientes encontrem e agendem consultas.</p>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              formControlName="showOnPublicSite"
              class="checkbox-input"
            />
            <span class="checkbox-text">
              <strong>Exibir clínica no site público</strong>
              <small>Permitir que a clínica apareça nos resultados de pesquisa</small>
            </span>
          </label>
        </div>

        <div class="form-group">
          <label for="clinicType">Tipo de Clínica *</label>
          <select 
            id="clinicType" 
            formControlName="clinicType"
            class="form-control"
            required
          >
            @for (type of clinicTypes; track type.value) {
              <option [value]="type.value">{{ type.label }}</option>
            }
          </select>
          <small class="form-help">Selecione o tipo principal da sua clínica</small>
        </div>

        <div class="form-group">
          <label for="whatsAppNumber">Número do WhatsApp (Opcional)</label>
          <input 
            type="tel" 
            id="whatsAppNumber" 
            formControlName="whatsAppNumber"
            placeholder="+5511999999999"
            class="form-control"
          />
          <small class="form-help">Inclua o código do país (ex: +55 para Brasil). Será exibido na página pública para contato direto.</small>
        </div>

        <div class="form-actions">
          <button 
            type="submit" 
            class="btn btn-primary" 
            [disabled]="settingsForm.invalid || isSaving()"
          >
            @if (isSaving()) {
              <span class="spinner"></span>
              <span>Salvando...</span>
            } @else {
              <span>Salvar Configurações</span>
            }
          </button>
        </div>
      </div>

      @if (currentSettings() && currentSettings()!.showOnPublicSite) {
        <div class="preview-card">
          <h3>Preview - Como sua clínica aparecerá</h3>
          <div class="clinic-preview">
            <div class="preview-type">
              <span class="type-badge">{{ getClinicTypeLabel(currentSettings()!.clinicType) }}</span>
            </div>
            <p class="preview-note">Sua clínica estará visível na página de pesquisa pública com as informações cadastradas.</p>
            @if (currentSettings()!.whatsAppNumber) {
              <p class="preview-whatsapp">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                </svg>
                WhatsApp disponível para contato
              </p>
            }
          </div>
        </div>
      }
    </form>
  }
</div>
